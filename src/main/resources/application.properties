# common config
quarkus.application.name=kamifusen
quarkus.application.version=0.9.0

quarkus.datasource.db-kind=postgresql
quarkus.datasource.reactive=true

# JDBC datasource for Flyway
quarkus.datasource.jdbc=true

quarkus.hibernate-orm.database.generation=none
quarkus.hibernate-orm.physical-naming-strategy=org.hibernate.boot.model.naming.CamelCaseToUnderscoresNamingStrategy
quarkus.hibernate-orm.dialect=org.hibernate.dialect.PostgreSQLDialect

# Flyway configuration
quarkus.flyway.migrate-at-start=true
quarkus.flyway.baseline-on-migrate=true
quarkus.flyway.baseline-version=0.9.0
quarkus.flyway.locations=classpath:db/migration

# Native compilation support for Flyway
quarkus.native.resources.includes=db/migration/**
quarkus.native.additional-build-args=-H:IncludeResources=db/migration/.*

quarkus.http.auth.basic=true
quarkus.http.auth.proactive=true
quarkus.http.auth.permission.basic.paths=/public/*
quarkus.http.auth.permission.basic.policy=authenticated

quarkus.http.auth.form.enabled=true
quarkus.http.auth.form.landing-page=/admin/landing
quarkus.http.auth.form.login-page=
quarkus.http.auth.form.error-page=/?error=invalid-credentials
quarkus.http.auth.form.post-location=j_security_check
quarkus.http.auth.form.username-parameter=username
quarkus.http.auth.form.password-parameter=password
quarkus.http.auth.form.http-only-cookie=true
quarkus.http.auth.form.cookie-name=AuthToken
quarkus.http.auth.form.timeout=P1D
quarkus.http.auth.form.new-cookie-interval=PT1M
quarkus.http.auth.form.cookie-same-site=strict
quarkus.http.auth.form.cookie-path=/
quarkus.http.auth.permission.form.paths=/api/*
quarkus.http.auth.permission.form.policy=authenticated

# Quinoa configuration
quarkus.quinoa.ui-dir=src/main/webui
quarkus.quinoa.build-dir=dist
quarkus.quinoa.dev-server.port=3000
quarkus.quinoa.dev-server.command=dev
quarkus.quinoa.package-manager-install=true
quarkus.quinoa.package-manager-install.node-version=22.9.0
quarkus.quinoa.package-manager-install.npm-version=11.3.0
quarkus.quinoa.package-manager=npm
quarkus.quinoa.enable-spa-routing=true
%dev.quarkus.quinoa.dev-server.managed=true

# Production build with environment variables
quarkus.quinoa.build-env.NODE_ENV=production
quarkus.quinoa.build-env.VITE_APP_VERSION=${quarkus.application.version}

# devservices configuration (test profile only)
%test.quarkus.hibernate-orm.database.generation=create-drop
%test.quarkus.http.test-port=0
%test.quarkus.datasource.devservices.image-name=postgres:15.2-alpine
%test.quarkus.hibernate-orm.sql-load-script=import.sql

# dev config
%dev.quarkus.http.cors=true
%dev.quarkus.http.cors.origins=https://www.tohuwabohu.io,http://localhost:3000
%dev.quarkus.datasource.username=kamifusen
%dev.quarkus.datasource.password=kamifusen
%dev.quarkus.datasource.reactive.url=postgresql://localhost:5432/dev

%dev.quarkus.live-reload.instrumentation=true
%dev.quarkus.hibernate-orm.database.generation=none
%dev.quarkus.flyway.clean-at-start=true
%dev.quarkus.http.auth.session.encryption-key=encryption-key-3000
%dev.quarkus.log.level=DEBUG